<div class="dialog-content overwrite-namespace" *ngIf="hasFilesToOverwrite">
  <div *ngFor="let entry of filesToOverwrite | keyvalue" class="namespace">
    <span class="namespace-name">{{ entry.key }}</span>
    <div class="file" *ngFor="let file of entry.value">
      <span class="file-name">{{ file }}</span>
      <div class="acceptance">
        <mat-button-toggle-group value="replace">
          <mat-button-toggle value="keep" (click)="keepFile(entry.key, file)">Keep old file</mat-button-toggle>
          <mat-button-toggle value="replace" (click)="replaceFile(entry.key, file)">Replace</mat-button-toggle>
        </mat-button-toggle-group>
      </div>
    </div>
  </div>
</div>

<ng-container *ngIf="!hasFilesToOverwrite">
  <button (click)="copySummaryToClipboard()" mat-icon-button matTooltip="You can also copy the validation result to clipboard">
    <mat-icon fontIcon="bosch-ic-copy"></mat-icon>
    <span>Copy to clipboard</span>
  </button>

  <div class="dialog-content">
    <div class="namespace-column">
      <mat-selection-list [multiple]="false">
        <mat-list-option *ngIf="missingFiles?.length" class="missing-files" (click)="visibleStep = step.missingFile">
          <div>
            <mat-icon fontIcon="bosch-ic-document-error"></mat-icon>
            <span>Missing files</span>
          </div>
        </mat-list-option>

        <mat-expansion-panel *ngFor="let namespace of namespaces | keyvalue" [expanded]="true">
          <mat-expansion-panel-header>
            <mat-panel-title matTooltip="Package for namespace {{ namespace.key }}">
              <mat-icon fontIcon="bosch-ic-folder"></mat-icon>
              <span>{{ namespace.key }}</span>
            </mat-panel-title>
          </mat-expansion-panel-header>

          <mat-panel-row>
            <mat-list-option
              *ngFor="let file of namespace.value"
              (click)="errors = file.errors; visibleStep = errors?.length ? step.hasErrors : step.noError"
            >
              <div class="content">
                <mat-icon fontIcon="bosch-ic-document"></mat-icon>
                <span>{{ file.file }}</span>
              </div>
              <div class="status">
                <mat-icon
                  *ngIf="file.errors?.length"
                  [fontIcon]="icons.violation"
                  matTooltip="This file has errors"
                  class="violation"
                ></mat-icon>
                <mat-icon
                  *ngIf="!file.errors?.length"
                  [fontIcon]="icons.success"
                  matTooltip="This file was validated with success"
                  class="success"
                ></mat-icon>
              </div>
            </mat-list-option>
          </mat-panel-row>
        </mat-expansion-panel>

        <mat-list-option *ngIf="incorrectFiles?.length" class="incorrect-files" (click)="visibleStep = step.incorrectFile">
          <div>
            <mat-icon fontIcon="bosch-ic-document-error"></mat-icon>
            <span>Incorrect files</span>
          </div>
        </mat-list-option>
      </mat-selection-list>
    </div>

    <div class="errors-column">
      <ng-container *ngIf="visibleStep === step.hasErrors">
        <p class="error-notifier" *ngIf="errors?.length">This model has the following errors:</p>
        <div class="notification" *ngFor="let error of errors">
          <mat-icon [fontIcon]="icons[error.resultSeverity]" class="notification-icon {{ error.resultSeverity }}"></mat-icon>
          <div class="notification-content">
            <p class="notification-name">{{ error.focusNode }}</p>
            <p class="notification-description">{{ error.resultMessage }}</p>
          </div>
        </div>
      </ng-container>

      <ng-container *ngIf="visibleStep === step.missingFile">
        <p class="error-notifier" *ngIf="missingFiles?.length">These files are required in the selected namespace:</p>
        <div class="notification" *ngFor="let missingFile of missingFiles">
          <mat-icon [fontIcon]="icons.violation" class="notification-icon violation"></mat-icon>
          <div class="notification-content">
            <p class="notification-name">{{ missingFile.analysedFile }}</p>
            <p class="notification-description">{{ missingFile.errorMessage }}</p>
          </div>
        </div>
      </ng-container>

      <div *ngIf="visibleStep === step.selection" class="no-notifications">
        <p>Select an Aspect Model to see the validation result.</p>
      </div>

      <div *ngIf="visibleStep === step.noError" class="no-notifications">
        <p>This file was validated successfully</p>
      </div>

      <div *ngIf="visibleStep === step.incorrectFile" class="incorrect-files">
        <p class="error-notifier">These files were not imported:</p>
        <div class="incorrect-file" *ngFor="let file of incorrectFiles">
          <p class="file-name">{{ file }}</p>
        </div>
      </div>
    </div>
  </div>
</ng-container>
